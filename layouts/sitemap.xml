{{- printf "<?xml version=\"1.0\" encoding=\"utf-8\"?>" | safeHTML }}
<!-- Generated by Hugo -->
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9
        http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd"
        xmlns:xhtml="http://www.w3.org/1999/xhtml"
        xmlns:image="http://www.google.com/schemas/sitemap-image/1.1"
        xmlns:video="http://www.google.com/schemas/sitemap-video/1.1"
        xmlns:news="http://www.google.com/schemas/sitemap-news/0.9">
  {{- $pages := .Site.AllPages }}
  {{- $now := now }}
  {{- $baseURL := .Site.BaseURL }}
  {{- $baseURL = trim $baseURL "/" }}
  
  <!-- Homepage -->
  <url>
    <loc>{{ $baseURL }}/</loc>
    <lastmod>{{ now.Format "2006-01-02T15:04:05-07:00" }}</lastmod>
    <changefreq>daily</changefreq>
    <priority>1.0</priority>
  </url>
  
  <!-- Main content pages -->
  {{- range $page := $pages }}
    {{- /* Skip pages that shouldn't be in sitemap */}}
    {{- if and (not .Params.noindex) (ne .Kind "404") (not .IsPage) (not .IsNode) }}
      {{- $lastmod := $page.Lastmod | default $page.Date }}
      {{- if gt $page.Lastmod $page.Date }}
        {{- $lastmod = $page.Lastmod }}
      {{- end }}
      
      <url>
        <loc>{{ .Permalink }}</loc>
        <lastmod>{{ $lastmod.Format "2006-01-02T15:04:05-07:00" }}</lastmod>
        
        {{- /* Set change frequency based on section */}}
        {{- if in $page.RelPermalink "/posts/" }}
          <changefreq>monthly</changefreq>
          <priority>0.8</priority>
        {{- else if in $page.RelPermalink "/categories/" }}
          <changefreq>weekly</changefreq>
          <priority>0.6</priority>
        {{- else if in $page.RelPermalink "/tags/" }}
          <changefreq>weekly</changefreq>
          <priority>0.5</priority>
        {{- else if in $page.RelPermalink "/about/" }}
          <changefreq>monthly</changefreq>
          <priority>0.7</priority>
        {{- else }}
          <changefreq>monthly</changefreq>
          <priority>0.6</priority>
        {{- end }}
        
        {{- /* Add images to sitemap */}}
        {{- $images := $page.Resources.ByType "image" }}
        {{- range $img := first 10 $images }}
          {{- $img = $img.Fit "1200x630" }}
          <image:image>
            <image:loc>{{ $img.Permalink | absURL }}</image:loc>
            {{- with $page.Title }}<image:title>{{ . | htmlEscape }}</image:title>{{ end }}
            {{- with $page.Description }}<image:caption>{{ . | htmlEscape }}</image:caption>{{ end }}
            {{- with $img.Exif }}<image:geo_location>{{ .Lat }},{{ .Long }}</image:geo_location>{{ end }}
          </image:image>
        {{- end }}
        
        {{- /* Add featured image if exists */}}
        {{- with .Params.featuredImage }}
          <image:image>
            <image:loc>{{ . | absURL }}</image:loc>
            {{- with $page.Title }}<image:title>{{ . | htmlEscape }}</image:title>{{ end }}
          </image:image>
        {{- end }}
        
        {{- /* Add alternate language versions */}}
        {{- if .IsTranslated -}}
          {{- range .Translations }}
            <xhtml:link rel="alternate" hreflang="{{ .Language.Lang }}" href="{{ .Permalink }}" />
          {{- end -}}
          <xhtml:link rel="alternate" hreflang="{{ .Language.Lang }}" href="{{ .Permalink }}" />
        {{- end -}}
      </url>
    {{- end }}
  {{- end }}
  
  <!-- Additional static pages -->
  <url>
    <loc>{{ $baseURL }}/about/</loc>
    <lastmod>{{ now.Format "2006-01-02T15:04:05-07:00" }}</lastmod>
    <changefreq>monthly</changefreq>
    <priority>0.7</priority>
  </url>
  
  <url>
    <loc>{{ $baseURL }}/contact/</loc>
    <lastmod>{{ now.Format "2006-01-02T15:04:05-07:00" }}</lastmod>
    <changefreq>monthly</changefreq>
    <priority>0.7</priority>
  </url>
  
  <url>
    <loc>{{ $baseURL }}/privacy/</loc>
    <lastmod>{{ now.Format "2006-01-02T15:04:05-07:00" }}</lastmod>
    <changefreq>yearly</changefreq>
    <priority>0.3</priority>
  </url>
  
  <url>
    <loc>{{ $baseURL }}/terms/</loc>
    <lastmod>{{ now.Format "2006-01-02T15:04:05-07:00" }}</lastmod>
    <changefreq>yearly</changefreq>
    <priority>0.3</priority>
  </url>
</urlset>
